

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="_static/favicon.ico" rel="icon" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Logging &mdash; Whenever 1.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=58fbf978"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Globals" href="35.globals.html" />
    <link rel="prev" title="Command Line Interface" href="20.cli.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Whenever
              <img src="_static/metronome.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="10.main.html">The <strong>whenever</strong> Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="20.cli.html">Command Line Interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="35.globals.html">Globals</a></li>
<li class="toctree-l1"><a class="reference internal" href="40.tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="50.conditions.html">Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="60.events.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="70.intcli.html">Input Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="80.build.html">Building <strong>whenever</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="90.install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="99.license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Whenever</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Logging</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/30.logging.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="logging">
<span id="id1"></span><h1>Logging<a class="headerlink" href="#logging" title="Link to this heading"></a></h1>
<p>Log messages are not dissimilar to the ones provided by servers and other applications running
in the background: a date/time specification is reported, as well as the name of the application
(<em>whenever</em>), the logging level to which the message line is pertinent, and then a message
(the so-called <em>payload</em>). The message itself is structured: it consists of a short <em>context</em>
specification, followed by a string enclosed in square brackets describing the nature of the
message (for instance if the message is referred to the start or to the end of a process, and
whether the message indicates a normal condition or something that went wrong). The context can
be either the <em>MAIN</em> control program (or one of its threads), a <em>TASK</em>, a <em>CONDITION</em>, an
<em>EVENT</em> or a <em>REGISTRY</em> – there are many registries in <strong>whenever</strong>, used by the main control
program to reach the <em>item</em> collections.</p>
<p>Logging is quite verbose in <strong>whenever</strong> at the <em>trace</em> log level, and can be very brief when
enabling logging just for warnings and errors.</p>
<p>A short description of the log levels follows:</p>
<ol class="arabic simple">
<li><p><strong>trace</strong>: every single step is logged, some messages can be redundant because if an
acknowledgement or an issue takes place in more than one context of the program, each of the
involved parts may decide to log about what happened. Sometimes, for example, the same error
may be reported by a condition that is checked and by the registry that has been used to reach
this condition. Also, <em>history</em> messages are issued only at the trace level: <em>wrappers</em> will
want to use the <em>trace</em> level in order to catch these messages and calculate, for instance,
the execution time for a particular task.</p></li>
<li><p><strong>debug</strong>: there is plenty of informational messages at each execution step, however
redundant messages are not emitted. In particular, <em>history</em> messages are not present at this
level.</p></li>
<li><p><strong>info</strong>: a reduced amount of informational messages is emitted, mostly related to the outcome
of conditions and execution of related tasks; information about what is being checked is less
verbose. Very reduced logging is performed at this level by the main control program, thus most
of the logging is left to items.</p></li>
<li><p><strong>warn</strong>: <strong>warnings</strong> are logged, that is erratic situations that can be handled by
<strong>whenever</strong> without having to stop or abort – note that termination requests are logged as
<strong>warnings</strong> instead of <strong>errors</strong>, even though they could be considered normal causes for
the scheduler to stop and exit.</p></li>
<li><p><strong>error</strong>: only <strong>errors</strong> are reported, which are erratic situations that may prevent
<strong>whenever</strong> to perform the requested operations or, in some cases, to keep running correctly.</p></li>
</ol>
<p>Note that, since <em>Lua</em> scripts are allowed to log at each of the above described levels, lines
emitted by <em>Lua</em> script might not always correspond to what is illustrated above.</p>
<p>As mentioned above, just after the <em>context</em>, in the message <em>payload</em>, a string of the form
<code class="docutils literal notranslate"><span class="pre">[WHEN/STATUS]</span></code> appears that can be used to better identify the reason why the message has
been issued, where</p>
<ul class="simple">
<li><p><em>WHEN</em> represents the <em>nature</em> of the log entry, and can be one of</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">INIT</span></code> when the message is related to an initialization phase (mostly around startup)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">START</span></code> when the message is issued when <em>starting</em> something, for instance a check or a new
process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PROC</span></code> when the message is issued in the middle of something, for instance while executing
a check</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">END</span></code> when the message is emitted at the end of something, before returning control</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HIST</span></code> when the message is intended for some receiver (generally a wrapper) that keeps track
of the history: in this case the <em>outcome</em> is either <code class="docutils literal notranslate"><span class="pre">START</span></code> or <code class="docutils literal notranslate"><span class="pre">END</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BUSY</span></code> when the message is intended for a receiver (generally a wrapper) that might show
whether the scheduler is busy<a class="footnote-reference brackets" href="#fn-1" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> or not: <em>outcome</em> is here <code class="docutils literal notranslate"><span class="pre">YES</span></code> or <code class="docutils literal notranslate"><span class="pre">NO</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PAUSE</span></code> when the message is intended for a receiver (generally a wrapper) that might show
whether the scheduler has been paused<a class="footnote-reference brackets" href="#fn-2" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> or resumed: <em>outcome</em> is here <code class="docutils literal notranslate"><span class="pre">YES</span></code> or
<code class="docutils literal notranslate"><span class="pre">NO</span></code>.</p></li>
</ul>
</li>
<li><p><em>STATUS</em> holds the <em>outcome</em> of the current activity, and is one of the following:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">OK</span></code> for expected behaviours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAIL</span></code> for unexpected behaviours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IND</span></code> when the outcome of an operation is undetermined</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MSG</span></code> when the message is merely informational</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ERR</span></code> when an operation fails with an error</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">START</span></code>/<code class="docutils literal notranslate"><span class="pre">END</span></code> are pseudo-outcomes that only occur when the <em>nature</em> is <code class="docutils literal notranslate"><span class="pre">HIST</span></code>, to
mark the beginning or the end of an activity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">YES</span></code>/<code class="docutils literal notranslate"><span class="pre">NO</span></code> are pseudo-outcomes that only occur when the <em>nature</em> is one of <code class="docutils literal notranslate"><span class="pre">BUSY</span></code> or
<code class="docutils literal notranslate"><span class="pre">PAUSE</span></code>, according to the actual busy state or to the fact that the scheduler has been
paused or resumed respectively.</p></li>
</ul>
</li>
</ul>
<p>This string appears <em>before</em> a human-readable message, so that it can be used by a wrapper to
filter or highlight an entry when displaying the log – completely or partially. Sometimes it might
seem that the expression in square bracket conflicts with the message body, a notable example being
a message similar to</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[2023-06-20T21:53:45.089] (whenever) INFO  CONDITION Cond_INTERVAL/6: [END/OK] failure: condition checked with negative outcome
</pre></div>
</div>
<p>while in fact this kind of message is absolutely legitimate: a negative outcome in condition
checking is expected quite often, this is the reason why the message documenting a failed check
is reported as a positive (<code class="docutils literal notranslate"><span class="pre">[END/OK]</span></code>) log entry.</p>
<p>There is an option that can be specified on the <a class="reference internal" href="20.cli.html#cli"><span class="std std-ref">command line</span></a>,
that forces the log lines to be emitted in the JSON format: this allows to separate the parts
more easily into a header (<code class="docutils literal notranslate"><span class="pre">&quot;header&quot;</span></code> field) that holds</p>
<ul class="simple">
<li><p>the log timestamp (<code class="docutils literal notranslate"><span class="pre">&quot;time&quot;</span></code>)</p></li>
<li><p>the application name (<code class="docutils literal notranslate"><span class="pre">&quot;application&quot;</span></code>)</p></li>
<li><p>log level (<code class="docutils literal notranslate"><span class="pre">&quot;level&quot;</span></code>)</p></li>
</ul>
<p>followed by the actual log contents, consisting of</p>
<ul class="simple">
<li><p>context (<code class="docutils literal notranslate"><span class="pre">&quot;context&quot;</span></code>), which contains</p>
<ul>
<li><p>the part of the scheduler that emits the message (<code class="docutils literal notranslate"><span class="pre">&quot;emitter&quot;</span></code>)</p></li>
<li><p>the action that is being performed, or the indication that an item is active (<code class="docutils literal notranslate"><span class="pre">&quot;action&quot;</span></code>)</p></li>
<li><p>the name and unique id of the item, if the message concerns an activated item (<code class="docutils literal notranslate"><span class="pre">&quot;item&quot;</span></code>
and <code class="docutils literal notranslate"><span class="pre">&quot;item_id&quot;</span></code>)</p></li>
</ul>
</li>
<li><p>the message type (<code class="docutils literal notranslate"><span class="pre">&quot;message_type&quot;</span></code>), consisting of</p>
<ul>
<li><p>the nature of the message (<code class="docutils literal notranslate"><span class="pre">&quot;when&quot;</span></code>)</p></li>
<li><p>the current outcome (<code class="docutils literal notranslate"><span class="pre">&quot;status&quot;</span></code>)</p></li>
</ul>
</li>
<li><p>a human readable message (<code class="docutils literal notranslate"><span class="pre">&quot;message&quot;</span></code>)</p></li>
</ul>
<p>in order to better handle the logs and to provide feedback to the user. A sample JSON record is
shown below:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;header&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;application&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;whenever&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;TRACE&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-11-04T11:17:25.257970&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;contents&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;scheduler_tick&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;emitter&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MAIN&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;item&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;item_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;condition Cond_TIME tested with no outcome (tasks not executed)&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;message_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MSG&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;when&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PROC&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The actual log record, also in JSON format, is emitted in the form of a single text line.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="fn-1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>that is, checking one or more conditions and/or running their related tasks.</p>
</aside>
<aside class="footnote brackets" id="fn-2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>the <em>PAUSE</em> line will be issued just once when the <code class="docutils literal notranslate"><span class="pre">pause</span></code> input command is invoked,
and once when the <code class="docutils literal notranslate"><span class="pre">resume</span></code> input command is issued.</p>
</aside>
</aside>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="20.cli.html" class="btn btn-neutral float-left" title="Command Line Interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="35.globals.html" class="btn btn-neutral float-right" title="Globals" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2026, Francesco Garosi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>